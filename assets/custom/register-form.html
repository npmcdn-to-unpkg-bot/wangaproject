<link rel="import" href="../components/polymer/polymer.html">

<dom-module id="register-form">

    
        <style>
            #loginBut {
                background: #4285f4;
                color: #fff;
                padding: 5px 10px;
                margin-right: 15px;;
            }
            .error {
                color:red;
            }
        </style>

        <template>

        <iron-ajax id="RegisterAjax"
                   method="POST"
                   contentType="application/json"
                   url="/register"
                   
                   on-response="Rresponse"
                   handleAs="json"
                   ></iron-ajax>


        <template repeat="{{ error in response.errors }}">
            <span class="error">{{ error.message }}</span>
            <br>
        </template>

        <paper-input label="First name" name="username" floatingLabel value="{{firstname}}"></paper-input>
        <paper-input label="Last name" name="username" floatingLabel value="{{lastname}}"></paper-input>
        <br>
        <paper-input id="inputForValidation" placeholder="Enter Your Email" auto-validate pattern="^(.)+@[a-z A-Z _]+?\.[a-zA-Z]{2,3}$" name="email" type="email" floatingLabel value="{{email::input}}" error-message="Enter valide email!"></paper-input>
        <br>
        <paper-input label="Password" id="pass" name="password" type="password" floatingLabel value="{{Passw::input}}" auto-validate errorMessage=""></paper-input>
        <br>
        <paper-input is="iron-input" label="Confirm Password" id="conf" name="confirm_password" auto-validate type="password" floatingLabel pattern={{Passw}} value="{{confPassw::input}}" error-message="password don't match"></paper-input>
        
        <br>
        <paper-button   label="Register" raisedButton name="register" id="loginBut" on-tap="submit">Register</paper-button>
        <content select="a"></content>
    </template>
    

</dom-module>


<script>
        Polymer({
            is:'register-form', 
            
            confirma: function(){
               
        if (this.confPassw != this.Passw) {
            console.log(this.confPassw);
            console.log("Passwords Don't Match");
            this.errorMessage="Passwords Don't Match";
        }else{
            var pass2 = document.getElementById('conf');
            pass2.errorMessage="good";
        };
    },
    submit:function(){
        console.log(this.firstname);
        console.log(this.lastname);
        console.log(this.Passw);
        console.log(this.confPassw);
        console.log(this.email);

        var userdata = JSON.stringify({firstname:this.firstname, lastname:this.lastname, password:this.Passw, confirm:this.confPassw , email:this.email});
        console.log(userdata);
        this.$.RegisterAjax.body = userdata;
        this.$.RegisterAjax.generateRequest();
         },
    Rresponse: function(r){
        console.log(r.detail.response);
        resp = r.detail.response;
        if(resp.registered == true){
            window.location.href = "/login";
        }
    },

    properties:{
        Passw:{
            type:String,
            value:"",
            notify:true
        },
        confPassw:{
            type:String,
            value:"",
            notify:true
        },
        firstname:{
            type:String,
            value:"",
            notify:true
        },
        lastname:{
            type:String,
            value:"",
            notify:true
        },
        email:{
            type:String,
            value:"",
            notify:true
        }
    }

           
        });
</script>